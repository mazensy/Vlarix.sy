<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Vlarix Premium Store</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #0088cc;
            --primary-light: #00aaff;
            --accent: #ff9500;
            --bg: var(--tg-theme-bg-color, #ffffff);
            --text: var(--tg-theme-text-color, #222222);
            --hint: var(--tg-theme-hint-color, #999999);
            --secondary-bg: var(--tg-theme-secondary-bg-color, #f4f4f7);
            --button: var(--tg-theme-button-color, #0088cc);
            --button-text: var(--tg-theme-button-text-color, #ffffff);
            --card-bg: var(--tg-theme-bg-color, #ffffff);
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: var(--secondary-bg);
            color: var(--text);
            margin: 0; padding: 0; overflow-x: hidden;
        }

        /* Header */
        .header {
            background-color: var(--bg);
            padding: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky; top: 0; z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .brand { display: flex; align-items: center; gap: 10px; }
        .logo {
            width: 35px; height: 35px;
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            border-radius: 10px;
            display: flex; align-items: center; justify-content: center;
            color: white; font-size: 1.1em;
        }

        .wallet-info {
            display: flex; flex-direction: column; align-items: flex-end;
        }

        .balance-box {
            background: var(--secondary-bg);
            padding: 5px 12px;
            border-radius: 15px;
            font-weight: bold;
            display: flex; align-items: center; gap: 5px;
            cursor: pointer;
        }

        .currency-toggle {
            font-size: 0.7em; color: var(--primary); font-weight: bold; margin-top: 2px;
        }

        /* Tabs */
        .tabs {
            display: flex; background: var(--bg); padding: 5px;
            margin: 15px; border-radius: 15px; gap: 5px;
        }

        .tab {
            flex: 1; padding: 10px; text-align: center;
            border-radius: 12px; font-weight: 600; font-size: 0.9em;
            cursor: pointer; transition: 0.3s;
        }

        .tab.active { background: var(--primary); color: white; }

        /* Search & Categories */
        .search-area { padding: 0 15px; margin-bottom: 15px; }
        .search-input {
            width: 100%; padding: 12px 15px; border-radius: 12px;
            border: none; background: var(--bg); color: var(--text);
            outline: none; box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }

        .cats {
            display: flex; overflow-x: auto; gap: 10px;
            padding: 0 15px 10px; scrollbar-width: none;
        }
        .cats::-webkit-scrollbar { display: none; }
        .cat {
            padding: 8px 15px; background: var(--bg); border-radius: 20px;
            white-space: nowrap; font-size: 0.85em; font-weight: 600;
            box-shadow: 0 2px 5px rgba(0,0,0,0.02);
        }
        .cat.active { background: var(--primary); color: white; }

        /* Services */
        .services { padding: 0 15px 80px; display: grid; gap: 12px; }
        .card {
            background: var(--bg); border-radius: 18px; padding: 15px;
            display: flex; flex-direction: column; gap: 10px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.02);
            border: 1px solid rgba(0,0,0,0.03);
        }
        .card-title { font-weight: 700; font-size: 0.95em; line-height: 1.4; }
        .card-footer {
            display: flex; justify-content: space-between; align-items: center;
            margin-top: 5px;
        }
        .price { font-weight: 800; color: var(--primary); font-size: 1.1em; }
        .order-btn {
            background: var(--primary); color: white; border: none;
            padding: 8px 18px; border-radius: 10px; font-weight: 700;
            font-size: 0.85em;
        }

        /* Deposit Section */
        .deposit-section { padding: 15px; display: none; animation: fadeIn 0.3s; }
        .method-card {
            background: var(--bg); border-radius: 15px; padding: 15px;
            margin-bottom: 12px; display: flex; align-items: center; gap: 15px;
            border: 1px solid rgba(0,0,0,0.03);
        }
        .method-icon {
            width: 45px; height: 45px; border-radius: 12px;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.2em; color: white;
        }

        /* Modal */
        .modal {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(4px);
            display: none; align-items: flex-end; z-index: 2000;
        }
        .sheet {
            background: var(--bg); width: 100%; border-radius: 25px 25px 0 0;
            padding: 25px; animation: slideUp 0.3s ease-out;
        }
        @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

        .input {
            width: 100%; padding: 14px; border-radius: 12px;
            border: 2px solid var(--secondary-bg); background: var(--secondary-bg);
            color: var(--text); margin: 10px 0; outline: none;
        }
        .input:focus { border-color: var(--primary); }

        .total-box {
            background: var(--secondary-bg); padding: 15px;
            border-radius: 15px; margin: 15px 0;
            display: flex; justify-content: space-between; align-items: center;
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="brand">
            <div class="logo"><i class="fas fa-v"></i></div>
            <div style="font-weight: 800; font-size: 1.1em;">VLARIX</div>
        </div>
        <div class="wallet-info">
            <div class="balance-box" onclick="toggleCurrency()">
                <i class="fas fa-wallet" style="color: var(--primary);"></i>
                <span id="balance-val">0.00</span>
                <span id="currency-label">$</span>
            </div>
            <div class="currency-toggle">Ø§Ø¶ØºØ· Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ù€ SYP</div>
        </div>
    </div>

    <div class="tabs">
        <div class="tab active" onclick="showTab('store')">ğŸ›’ Ø§Ù„Ù…ØªØ¬Ø±</div>
        <div class="tab" onclick="showTab('deposit')">ğŸ’³ Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯</div>
        <div class="tab" onclick="showTab('orders')">ğŸ“‹ Ø·Ù„Ø¨Ø§ØªÙŠ</div>
    </div>

    <!-- Store Tab -->
    <div id="store-tab">
        <div class="search-area">
            <input type="text" class="search-input" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† Ø®Ø¯Ù…Ø©..." id="search">
        </div>
        <div class="cats" id="cats-list">
            <div class="cat active" data-cat="all">Ø§Ù„ÙƒÙ„</div>
            <div class="cat" data-cat="instagram">Ø¥Ù†Ø³ØªØºØ±Ø§Ù…</div>
            <div class="cat" data-cat="tiktok">ØªÙŠÙƒ ØªÙˆÙƒ</div>
            <div class="cat" data-cat="facebook">ÙÙŠØ³Ø¨ÙˆÙƒ</div>
            <div class="cat" data-cat="telegram">ØªÙ„ØºØ±Ø§Ù…</div>
        </div>
        <div class="services" id="services-list"></div>
    </div>

    <!-- Deposit Tab -->
    <div id="deposit-tab" class="deposit-section">
        <h3 style="margin-top: 0;">Ø§Ø®ØªØ± ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ø´Ø­Ù†</h3>
        <div class="method-card" onclick="depositInfo('Ø³ÙŠØ±ÙŠØªÙ„ ÙƒØ§Ø´')">
            <div class="method-icon" style="background: #e60000;"><i class="fas fa-mobile-alt"></i></div>
            <div>
                <div style="font-weight: bold;">Ø³ÙŠØ±ÙŠØªÙ„ ÙƒØ§Ø´</div>
                <div style="font-size: 0.8em; color: var(--hint);">Ø´Ø­Ù† ÙÙˆØ±ÙŠ Ø¹Ø¨Ø± Ø§Ù„ØªØ­ÙˆÙŠÙ„</div>
            </div>
        </div>
        <div class="method-card" onclick="depositInfo('Ø´Ø±ÙƒØ© Ø§Ù„Ù‡Ø±Ù…')">
            <div class="method-icon" style="background: #008000;"><i class="fas fa-money-bill-wave"></i></div>
            <div>
                <div style="font-weight: bold;">Ø´Ø±ÙƒØ© Ø§Ù„Ù‡Ø±Ù… / Ø§Ù„ÙØ¤Ø§Ø¯</div>
                <div style="font-size: 0.8em; color: var(--hint);">Ø­ÙˆØ§Ù„Ø§Øª Ù…Ø§Ù„ÙŠØ© Ù…Ù† ÙƒØ§ÙØ© Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª</div>
            </div>
        </div>
        <div class="method-card" onclick="depositInfo('ÙƒÙˆØ¯ Ø´Ø­Ù†')">
            <div class="method-icon" style="background: var(--primary);"><i class="fas fa-key"></i></div>
            <div>
                <div style="font-weight: bold;">ÙƒÙˆØ¯ Ø´Ø­Ù† (Gift Card)</div>
                <div style="font-size: 0.8em; color: var(--hint);">Ø£Ø¯Ø®Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„ÙŠØªÙ… Ø§Ù„Ø´Ø­Ù† ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹</div>
            </div>
        </div>
    </div>

    <!-- Modal Order -->
    <div class="modal" id="order-modal">
        <div class="sheet">
            <div style="width: 40px; height: 4px; background: var(--secondary-bg); margin: 0 auto 15px; border-radius: 10px;"></div>
            <h3 id="m-title" style="margin: 0 0 10px;"></h3>
            <p id="m-desc" style="font-size: 0.85em; color: var(--hint); margin-bottom: 15px;"></p>
            
            <label style="font-size: 0.85em; font-weight: bold;">Ø±Ø§Ø¨Ø· Ø§Ù„Ø­Ø³Ø§Ø¨ / Ø§Ù„Ù…Ù†Ø´ÙˆØ±</label>
            <input type="text" class="input" id="m-link" placeholder="https://...">
            
            <label style="font-size: 0.85em; font-weight: bold;">Ø§Ù„ÙƒÙ…ÙŠØ©</label>
            <input type="number" class="input" id="m-qty" value="1000">

            <div class="total-box">
                <span style="font-weight: bold;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
                <span id="m-total" style="font-weight: 900; color: var(--primary); font-size: 1.2em;">0.00 $</span>
            </div>

            <button class="order-btn" style="width: 100%; padding: 15px; font-size: 1em;" onclick="confirmOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>
            <button style="width: 100%; background: none; border: none; color: var(--hint); margin-top: 10px;" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        let currentCurrency = 'USD';
        let exchangeRate = 15000; // Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ Ù…Ù† Ø§Ù„Ø¨ÙˆØª
        let userBalanceUSD = 0;

        const services = [
            { id: 1, cat: 'instagram', name: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† Ø¥Ù†Ø³ØªØºØ±Ø§Ù… - Ø¬ÙˆØ¯Ø© VIP', rate: 0.80, min: 100, desc: 'Ø­Ø³Ø§Ø¨Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ©ØŒ Ø¶Ù…Ø§Ù† ØªØ¹ÙˆÙŠØ¶ 30 ÙŠÙˆÙ….' },
            { id: 2, cat: 'instagram', name: 'Ù„Ø§ÙŠÙƒØ§Øª Ø¥Ù†Ø³ØªØºØ±Ø§Ù… - Ø³Ø±ÙŠØ¹Ø© Ø¬Ø¯Ø§Ù‹', rate: 0.10, min: 50, desc: 'Ø¨Ø¯Ø¡ ÙÙˆØ±ÙŠØŒ Ø³Ø±Ø¹Ø© Ø¹Ø§Ù„ÙŠØ©.' },
            { id: 3, cat: 'tiktok', name: 'Ù…ØªØ§Ø¨Ø¹ÙŠÙ† ØªÙŠÙƒ ØªÙˆÙƒ - Ø¹Ø§Ù„Ù…ÙŠ', rate: 0.75, min: 100, desc: 'Ø³Ø±Ø¹Ø© Ù…Ù…ØªØ§Ø²Ø©ØŒ Ø­Ø³Ø§Ø¨Ø§Øª Ù…ØªÙ†ÙˆØ¹Ø©.' },
            { id: 4, cat: 'telegram', name: 'Ø£Ø¹Ø¶Ø§Ø¡ Ù‚Ù†ÙˆØ§Øª ØªÙ„ØºØ±Ø§Ù…', rate: 1.20, min: 100, desc: 'Ø£Ø¹Ø¶Ø§Ø¡ Ø­Ù‚ÙŠÙ‚ÙŠÙŠÙ† Ù„Ø²ÙŠØ§Ø¯Ø© Ø§Ù„ØªÙØ§Ø¹Ù„.' },
            { id: 5, cat: 'facebook', name: 'Ù„Ø§ÙŠÙƒØ§Øª Ù…Ù†Ø´ÙˆØ±Ø§Øª ÙÙŠØ³Ø¨ÙˆÙƒ', rate: 0.40, min: 200, desc: 'Ù„Ø§ÙŠÙƒØ§Øª Ø¹Ø±Ø¨ÙŠØ© ÙˆØ£Ø¬Ù†Ø¨ÙŠØ© Ù…Ø®ØªÙ„Ø·Ø©.' }
        ];

        let activeSrv = null;

        function init() {
            const params = new URLSearchParams(window.location.search);
            userBalanceUSD = parseFloat(params.get('balance')) || 0;
            exchangeRate = parseFloat(params.get('rate')) || 15000;
            updateBalanceDisplay();
            renderStore();
        }

        function updateBalanceDisplay() {
            const val = currentCurrency === 'USD' ? userBalanceUSD : userBalanceUSD * exchangeRate;
            document.getElementById('balance-val').innerText = val.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
            document.getElementById('currency-label').innerText = currentCurrency === 'USD' ? '$' : 'Ù„.Ø³';
            document.querySelector('.currency-toggle').innerText = currentCurrency === 'USD' ? 'Ø§Ø¶ØºØ· Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ù€ SYP' : 'Ø§Ø¶ØºØ· Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ù„Ù€ USD';
        }

        function toggleCurrency() {
            currentCurrency = currentCurrency === 'USD' ? 'SYP' : 'USD';
            updateBalanceDisplay();
            renderStore();
            tg.HapticFeedback.selectionChanged();
        }

        function renderStore(filter = 'all', search = '') {
            const container = document.getElementById('services-list');
            container.innerHTML = '';
            const filtered = services.filter(s => (filter === 'all' || s.cat === filter) && s.name.toLowerCase().includes(search.toLowerCase()));

            filtered.forEach(s => {
                const price = currentCurrency === 'USD' ? s.rate : s.rate * exchangeRate;
                const unit = currentCurrency === 'USD' ? '$' : 'Ù„.Ø³';
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="card-title">${s.name}</div>
                    <div style="font-size: 0.8em; color: var(--hint);">Ø§Ù„Ø­Ø¯ Ø§Ù„Ø£Ø¯Ù†Ù‰: ${s.min}</div>
                    <div class="card-footer">
                        <div class="price">${price.toFixed(currentCurrency === 'USD' ? 2 : 0)} ${unit} <small style="font-size: 0.6em; color: var(--hint);">/ 1000</small></div>
                        <button class="order-btn" onclick="openOrder(${s.id})">Ø·Ù„Ø¨</button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function showTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            document.getElementById('store-tab').style.display = tab === 'store' ? 'block' : 'none';
            document.getElementById('deposit-tab').style.display = tab === 'deposit' ? 'block' : 'none';
            tg.HapticFeedback.impactOccurred('light');
        }

        function openOrder(id) {
            activeSrv = services.find(s => s.id === id);
            document.getElementById('m-title').innerText = activeSrv.name;
            document.getElementById('m-desc').innerText = activeSrv.desc;
            document.getElementById('m-qty').value = activeSrv.min;
            document.getElementById('order-modal').style.display = 'flex';
            updateTotal();
        }

        function closeModal() { document.getElementById('order-modal').style.display = 'none'; }

        function updateTotal() {
            const qty = document.getElementById('m-qty').value;
            const total = (qty / 1000) * activeSrv.rate;
            const displayTotal = currentCurrency === 'USD' ? total : total * exchangeRate;
            const unit = currentCurrency === 'USD' ? '$' : 'Ù„.Ø³';
            document.getElementById('m-total').innerText = displayTotal.toLocaleString() + ' ' + unit;
        }

        document.getElementById('m-qty').oninput = updateTotal;
        document.getElementById('search').oninput = (e) => renderStore('all', e.target.value);

        document.querySelectorAll('.cat').forEach(c => {
            c.onclick = () => {
                document.querySelectorAll('.cat').forEach(i => i.classList.remove('active'));
                c.classList.add('active');
                renderStore(c.dataset.cat);
            };
        });

        function confirmOrder() {
            const link = document.getElementById('m-link').value;
            const qty = document.getElementById('m-qty').value;
            if(!link) { tg.showAlert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø±Ø§Ø¨Ø·!'); return; }
            
            tg.showConfirm('ØªØ£ÙƒÙŠØ¯ Ø·Ù„Ø¨ ' + qty + ' Ù…Ù† ' + activeSrv.name + 'ØŸ', (ok) => {
                if(ok) {
                    tg.sendData(JSON.stringify({action: 'new_order', id: activeSrv.id, link: link, qty: qty}));
                    tg.close();
                }
            });
        }

        function depositInfo(method) {
            tg.showAlert('Ù„Ø´Ø­Ù† Ø§Ù„Ø±ØµÙŠØ¯ Ø¹Ø¨Ø± ' + method + 'ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ ÙÙŠ Ø§Ù„Ø¨ÙˆØª Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ©.');
        }

        init();
    </script>
</body>
</html>
